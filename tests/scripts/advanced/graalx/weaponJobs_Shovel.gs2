//#CLIENTSIDE
function onCreated() {
  //this.sandtiles = {1124, 1125, 1140, 1141, 1184, 1185, 1186, 1187, 1200, 1201, 1202, 1203, 1184, 1185, 1186, 1187, 1200, 1201, 1202, 1203, 1216, 1217, 1218, 1219, 1232, 1233, 1234, 1235};
  //this.grasstiles = {1263, 1760, 1761, 1762, 1279, 1776, 1777, 1778, 1295, 1792, 1793, 1794, 1311, 1808, 1809, 1810};
  //this.dirttiles = {1660, 1661, 1662, 1663, 1676, 1677, 1678, 1679, 1692, 1693, 1694, 1695, 1708, 1709, 1710, 1711};
  this.dirttiles = {1301, 1302, 1317, 1318};
  //this.sandholetiles = {1158, 1159, 1174, 1175};
}

function onWeaponFired() {
  temp.muditem = new TStaticVar();
  temp.muditem.loadvarsfromarray(makevar("clientr.muditem_" @ client.selectedweapon));
  if (this.inuse == false && temp.muditem.quantity >= 1 && temp.muditem.tool == "Shovel") {
    this.inuse = true;
    setani("gx_shovelani", NULL);
    this.tilecheck = tiles[player.x, player.y];
    triggeraction(player.x + 1.5 + vecx(player.dir) * 2, player.y + 1.5 + vecy(player.dir) * 2, "dig", NULL);
    this.conclude = onTileCheck();
    if (this.conclude != "")
      triggerserver("gui", name, "layholes", this.dirpos[0], this.dirpos[1], this.conclude);
    playerfreeze = 0.7;
    sleep(0.65);
    this.inuse = false;
  }
}

function onTileCheck() {
  this.dirpos = {player.x + 1.5 + vecx(player.dir) * 2, player.y + 1.5 + vecy(player.dir) * 2};
  this.checks = {{this.dirpos[0] - 1, this.dirpos[1]}, {this.dirpos[0] - 1, this.dirpos[1] + 1.5},
                 {this.dirpos[0] - 1, this.dirpos[1] + 1}, {this.dirpos[0] - 1, this.dirpos[1] + 1.5}};
  this.checkstatus = 0;
  this.dirpos = {this.checks[player.dir][0], this.checks[player.dir][1]};
  for (i=0; i < this.checks.size(); i++) {
    if (tiles[this.checks[i][0], this.checks[i][1]] in this.sandtiles) 
      this.checkstatus = 1;
    elseif (tiles[this.checks[i][0], this.checks[i][1]] in this.grasstiles) 
      this.checkstatus = 2;
    elseif (tiles[this.checks[i][0], this.checks[i][1]] in this.dirttiles) 
      this.checkstatus = 3;
    else
      return false;
  }
  if (this.checkstatus == 1)
    return "sand";
  elseif (this.checkstatus == 2)
    return "grass";
  elseif (this.checkstatus == 3)
    return "dirt";
  else
    return false;
}